---
title:  "React Native Weekly - W21 2021"
description:  "React Native Weekly - W21 2021"
publishDate: 2021-05-23
tags:    ["react-native", "react-native-weekly"]
---

Welcome to the tenth edition of React Native Weekly. This is week 21 of 2021.

Reach out to me via Twitter if you have any feedback, and don't forget to subscribe!


# Curated List Of Native Modules

Someone (can't see their name) [tweet](https://twitter.com/HJahneer/status/1396078967392808961?s=20l) [a curated list](https://github.com/prscX/awesome-react-native-native-modules) of native modules in a Github repo.  I thought this was a good idea which would be nice to have it centralized under the React Native Community.


# Build A Game With React Native?

[This article hosted by Software Mansion](https://blog.swmansion.com/reanimated-2-the-game-9402622c1fe5) and written by Wojciech Stanisz goes over some techniques he used with Reanimated 2 to build his game.


# Coinbase's Article On Its Animated TabBar

<div style={{ borderLeft: "4px solid gray", paddingLeft: 20 }}>

At Coinbase one of the biggest risks for our React Native rewrite was overcoming the stigma that "you can't build great UX with React Native".

Today we're publishing some of the interaction details we sweat in order to prove that sentiment wrong.

</div>

[Tweet](https://twitter.com/fat/status/1395127632996409345?s=20)

# A Guide To React Native Optmization

[This video by the evening kid](https://www.youtube.com/watch?v=NDe3kjHBIWY&t=54s) is based on Callstack's eBook. It is short and straight to the point.


# Accessibility Improvements

There were two external contributions to accessibility.

- [35dd86180ba](https://github.com/facebook/react-native/commit/35dd86180ba) Fix/30842 - Add accessibilityState prop in slider (#31145)

Accessibility service does not announce "selected" on accessibilityState =
`{selected: true}` of the Button Component. Issue link - https://github.com/facebook/react-native/issues/30956

- [ea609defe84](https://github.com/facebook/react-native/commit/ea609defe84) Disable TouchableOpacity when accessibility disabled is set (#31108)

When using a screen reader the TouchableOpacity component disables click functionality.
Fixes Issue https://github.com/facebook/react-native/issues/30951



# Add Android 12 BLUETOOTH_[CONNECT/SCAN] to PermissionsAndroid

[eeb8e5829e1](https://github.com/facebook/react-native/commit/eeb8e5829e1) feat: add Android 12 BLUETOOTH_[CONNECT/SCAN] to PermissionsAndroid (#31488)

This PR adds BLUETOOTH_CONNECT / BLUETOOTH_SCAN, which showed up in the latest Android 12 Preview build as new `dangerous` permissions requiring approval for them.


# Shipped The New Diff Algorithm to iOS

[d393cc4814d](https://github.com/facebook/react-native/commit/d393cc4814d) Ship new differ on iOS

> While we are still waiting for Android results, we can safely ship this on iOS.



# Add ios_assume_nonnull flag to Rect Native Codegen

[This was a change](https://github.com/facebook/react-native/commit/fa4045e4dd7) intended to deal with an Objective-C compiler issue because the code generated by codegen had partially annotation. The interesting part is learning how the codegen will translate nullabable types and how this impacts Lightspeed and Instagram apps.

<div style={{ borderLeft: "4px solid gray", paddingLeft: 20 }}>

Changelog:
[iOS][Added] - Description

When compiling iOS apps with flag `-Wnullability-completeness` (like Lightspeed app and soon Instagram), Objective-C headers are required to either have full *explicit* nullability annotations on all members of its public API, or none at all; partially annotated headers will fail to build that module.

RN native modules are currently generated with *partial* annotations.  This works today because most apps are not compiled with `-Wnullability-completeness` turned on. But when we flip the switch for Instagram, the app doesn't build due to importing these RN partially annotated modules.

JavsScript Flow types are implied nonnull, and the current RN codegen translates Flow's [maybe/optional](https://flow.org/en/docs/types/maybe/) type to Obj-C `_Nullable` annotation, and everything else without an explicit Obj-C annotation. However this creates a mismatch with the Obj-C type system, where the implied default is *unannotated*, which is handled differently from nonnull when built with the nullability compiler flags.

</div>



# Proposed Fix For ScrollView Race Condition Between C++ State Update And OnScroll [Fabric]

[b161241db2e](https://github.com/facebook/react-native/commit/b161241db2e) Proposed fix for ScrollView race condition between C++ state update and onScroll.


In Fabric, usage of `measure` relies on C++ having an accurate view of the current scroll position of the ScrollView, and sometimes the C++ update will lose and C++ will have an inaccurate view of the world when FlatList receives the onScroll event and calls `measure`.

<div style={{ borderLeft: "4px solid gray", paddingLeft: 20 }}>

My proposed solution, gated behind a feature flag, is to delay /some/ onScroll events until the C++ UpdateState has made its way back to Java, and send UpdateStates more frequently. The balance here is that UpdateState is a relatively expensive operation, so we probably still want to call it /less/ than we call onScroll. This means that `measure` will still return some incorrect results but will return correct results more frequently. Win?

</div>

# Fix Hermes Build on iOS

If you were experiencing issues with building Hermes on iOS on version 0.65 [this commit](https://github.com/facebook/react-native/commit/59abb5f378e) fixes it.


# Introduce RCTInitializing

[9b45df1fced](https://github.com/facebook/react-native/commit/9b45df1fced) introduces an initializer for NativeModules.

**Motivation**

NativeModules need a way to execute custom initialization code. The current way to achieve this is by overriding the setBridge: method. This doesn't work in bridgeless mode, because in bridgeless mode, the TurboModule system doesn't (and shouldn't) invoke the setBridge: method.

**Changes**

This diff introduces a new protocol RCTInitializing that NativeModules can conform to. Once they conform to this protocol, they can implement the `- (void)initialize;` method. Both the NativeModule and TurboModule infra will execute this method towards the end of NativeModule setup.


Related changes:

a2ab3fccd04 Migrate RCTNativeAnimatedTurboModule to initialize
8aa85241a43 Migrate RCTDevSettings to initialize
ed86891d012 Migrate NativeModules to initialize



# Replace EventDispatcherImpl with LockFreeEventDispatcherImpl [Android]

I wanted to include [this change](https://github.com/facebook/react-native/commit/05108211705) in this week's log, but I don't have much I can say about it. Joshua Gross joshuagross@fb.com explains in his commit that he is concerned with the performance implications of the original `EventDispatcherImpl` because it uses synchronized blocks to make it thread-safe.


# Move isColorMeaningful to platform specific code

[A contribution from Microsoft](7aeac4236fc) to move isColorMeaningful to platform specific code (#31557).

<div style={{ borderLeft: "4px solid gray", paddingLeft: 20 }}>

`isColorMeaningful` is the only place in xplat code that currently uses `colorComponentsFromColor`, which assumes that a color is an RGBA value.  When implementing `PlatformColor` for windows, where colors might be complex patterns or effects, I'd like to keep the details of `SharedColor` isolated within `SharedColor`.  This change moves `isColorMeaningful` into `color.cpp`, where each platform can provide an implementation that takes into account its platform specific color capabilities.

</div>


# That Is It!

That's it for this week. If you want to see more checkout previous week's posts [here](/tags/react-native). Subscribe to get notified when new posts are out = )


